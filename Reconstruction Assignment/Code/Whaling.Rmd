---
title: "Whaling"
author: "Danielle Moffat"
date: "2024-08-27"
output: html_document
---

# Now let's import our whaling dataset
```{r}
library(readxl)
Whaling <- read_csv("~/Data_Science_R/Whaling.csv")
View(Whaling)
```

# Adding tidyverse and ggthemes
```{r}
library(tidyverse)
library(ggthemes)
```


# Command Option i is a shortcut for a ```{r} chunk
```{r}
# Load necessary libraries
library(ggplot2)
library(dplyr)

# Create the dataframe from data
data <- data.frame(
  Year = c("2005/2006", "2006/2007", "2007/2008", "2008/2009", "2009/2010", 
           "2010/2011", "2011/2012", "2012/2013", "2013/2014", "2014/2015", 
           "2015/2016", "2016/2017"),
  Traditional = c(370.2644248, 356.2728879, 355.607648, 335.5912279, 323.0344189, 
                  393.2200695, 379.0281494, 360.5819389, 375.4910201, 347.8803185, 
                  323.8298673, 342.5012047),
  Commercial = c(1011.635614, 903.9085279, 957.9556204, 910.3982678, 1009.914914, 
                 1062.396665, 953.4867496, 872.3842685, 1131.191396, 1234.52222, 
                 1153.706116, 972.925141),
  Scientific = c(2295.065137, 1836.919071, 1915.443342, 1910.548352, 1827.760462, 
                 1508.887037, 1491.597695, 1294.220201, 1601.640952, 1431.461224, 
                 1664.240028, 1454.291933)
)

# Melt the data for plotting
data_long <- data %>%
  pivot_longer(cols = c("Traditional", "Commercial", "Scientific"), 
               names_to = "Type", 
               values_to = "Mortality")

# Preview the data
print(data_long)
```

```{r}
# Create the line graph
ggplot(data_long, aes(x = Year, y = Mortality, color = Type, group = Type)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Whale Mortality by Type of Whaling",
    x = "Year",
    y = "Mortality",
    color = "Type of Whaling"
  ) +
  theme_minimal() +
  scale_color_brewer(palette = "Set1") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



